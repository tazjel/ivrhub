{% extends "layout.html" %}

{% block head %}
{% endblock %}

{% block body %}
<div class='row'>
    <div class='offset3 span6'>
        <form class='form-horizontal' action="{{ url_for('forgot', code=user.forgot_password_code) }}" method=post id='new_password_form'>
            <fieldset>
                <legend>Choose a new password for {{ user.email }}</legend>
                <div class='control-group'>
                    <label class='control-label' for='password'>Password</label>
                    <div class='controls'>
                        <input type='password' class='input-xlarge' name='password' id='password'>
                    </div>
                </div>
                <div class='control-group'>
                    <label class='control-label' for='password'>Retype Password</label>
                    <div class='controls'>
                        <input type='password' class='input-xlarge' name='retype_password' id='retype_password'>
                    </div>
                </div>
                <input name=_csrf_token type=hidden value="{{ csrf_token() }}">

                <div class='form-actions'>
                    <button type='submit' class='btn btn-primary'>Change</button>
                    <button type='reset' class='btn'>Cancel</button>
                </div>
            </fieldset>
        </form>
    </div>
</div>

{% endblock %}

{% block js %}
<script src="{{ url_for('static', filename='js/happy.js') }}"></script>
<script src="{{ url_for('static', filename='js/happy.methods.js') }}"></script>
<script>
    $(function() {
        // initial focus on first input
        $('#password').focus();

        $('#password_reset_form').isHappy({
            fields: {
                '#password': {
                    required: true
                    , message: 'please submit a password'
                }
                , '#retype_password': {
                    required: true
                    , message: 'please retype your password'
                    , test: happy.equal('#password')
                }
            }
        });

    });
</script>
{% endblock %}
